<!DOCTYPE html>
<html lang="pl">
<head>
    <link rel="icon" type="image/png" href="./favicon.png"/>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Breakout - Ekran Wygranej</title>
    <style>
        body {
            background-color: #1a1a1a;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            color: white;
            font-family: 'Arial Black', sans-serif;
            overflow: hidden;
        }

        #game-container {
            position: relative;
            width: 480px;
            height: 320px;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }

        canvas {
            background: #111;
            display: block;
            border: 4px solid #333;
            border-radius: 10px;
        }

        /* Styl nak≈Çadek */
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            z-index: 20;
            text-align: center;
            display: none; /* Domy≈õlnie ukryte */
        }

        /* EKRAN WYGRANEJ - Z≈ÅOTY */
        #win-screen {
            background: rgba(0, 0, 0, 0.9);
            border: 4px solid #ffd700;
        }
        #win-screen h1 {
            color: #ffd700;
            font-size: 50px;
            margin: 0;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
        }
        .trophy { font-size: 60px; margin-bottom: 10px; }

        /* EKRAN PRZEGRANEJ - CZERWONY */
        #lose-screen {
            background: rgba(20, 0, 0, 0.9);
            border: 4px solid #ff4757;
        }
        #lose-screen h1 { color: #ff4757; }

        /* MENU */
        #menu { background: #222; display: flex; }

        button {
            padding: 12px 25px;
            font-size: 16px;
            margin: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-transform: uppercase;
            font-weight: bold;
            transition: 0.3s;
        }

        .btn-main { background: #ffd700; color: #000; }
        .btn-restart { background: #0095DD; color: white; }
        button:hover { transform: scale(1.1); filter: brightness(1.2); }

        .score-display { font-size: 20px; color: #fff; margin: 10px 0; }
    </style>
</head>
<body>

<div id="game-container">
    <canvas id="myCanvas" width="480" height="320"></canvas>

    <!-- Menu G≈Ç√≥wne -->
    <div id="menu" class="overlay">
        <h1 style="color: #0095DD;">BREAKOUT</h1>
        <button class="btn-main" onclick="startGame()">Graj teraz</button>
    </div>

    <!-- Ekran Wygranej -->
    <div id="win-screen" class="overlay">
        <div class="trophy">üèÜ</div>
        <h1>WYGRANA!</h1>
        <p class="score-display">Wszystkie ceg≈Çy zniszczone!</p>
        <button class="btn-main" onclick="startGame()">Graj ponownie</button>
        <button class="btn-restart" style="background:#555" onclick="showMenu()">Menu</button>
    </div>

    <!-- Ekran Przegranej -->
    <div id="lose-screen" class="overlay">
        <h1>GAME OVER</h1>
        <p id="final-score" class="score-display">Wynik: 0</p>
        <button class="btn-restart" onclick="startGame()">Spr√≥buj ponownie</button>
        <button class="btn-restart" style="background:#555" onclick="showMenu()">Menu</button>
    </div>
</div>

<script>
    const canvas = document.getElementById("myCanvas");
    const ctx = canvas.getContext("2d");
    
    // Elementy UI
    const screens = {
        menu: document.getElementById("menu"),
        win: document.getElementById("win-screen"),
        lose: document.getElementById("lose-screen")
    };

    let x, y, dx, dy, paddleX, score, gameRunning = false;
    const ballRadius = 10, paddleWidth = 80, paddleHeight = 10;
    const rowCount = 3, colCount = 5;
    let bricks = [];

    function hideAllScreens() {
        Object.values(screens).forEach(s => s.style.display = "none");
    }

    function initGame() {
        x = canvas.width / 2;
        y = canvas.height - 30;
        dx = 3; dy = -3;
        paddleX = (canvas.width - paddleWidth) / 2;
        score = 0;
        bricks = [];
        for(let c=0; c<colCount; c++) {
            bricks[c] = [];
            for(let r=0; r<rowCount; r++) {
                bricks[c][r] = { x: 0, y: 0, status: 1 };
            }
        }
    }

    function startGame() {
        hideAllScreens();
        initGame();
        gameRunning = true;
        draw();
    }

    function showMenu() {
        hideAllScreens();
        screens.menu.style.display = "flex";
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    function victory() {
        gameRunning = false;
        screens.win.style.display = "flex";
    }

    function gameOver() {
        gameRunning = false;
        document.getElementById("final-score").innerText = "Wynik: " + score;
        screens.lose.style.display = "flex";
    }

    // Sterowanie
    document.addEventListener("mousemove", (e) => {
        const rect = canvas.getBoundingClientRect();
        const relativeX = e.clientX - rect.left;
        if (relativeX > 0 && relativeX < canvas.width) {
            paddleX = relativeX - paddleWidth / 2;
        }
    });

    function draw() {
        if (!gameRunning) return;

        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Rysowanie cegie≈Ç
        let activeBricks = 0;
        for(let c=0; c<colCount; c++) {
            for(let r=0; r<rowCount; r++) {
                if(bricks[c][r].status === 1) {
                    activeBricks++;
                    let bx = c*(75+10)+35;
                    let by = r*(20+10)+40;
                    bricks[c][r].x = bx;
                    bricks[c][r].y = by;
                    ctx.fillStyle = "#ff4757";
                    ctx.fillRect(bx, by, 75, 20);
                    
                    // Kolizja z ceg≈ÇƒÖ
                    if(x > bx && x < bx+75 && y > by && y < by+20) {
                        dy = -dy;
                        bricks[c][r].status = 0;
                        score++;
                    }
                }
            }
        }

        if(activeBricks === 0) { victory(); return; }

        // Pi≈Çka
        ctx.beginPath();
        ctx.arc(x, y, ballRadius, 0, Math.PI*2);
        ctx.fillStyle = "#ffd700";
        ctx.fill();
        ctx.closePath();

        // Paletka
        ctx.fillStyle = "#0095DD";
        ctx.fillRect(paddleX, canvas.height-paddleHeight, paddleWidth, paddleHeight);

        // ≈öciany
        if(x + dx > canvas.width-ballRadius || x + dx < ballRadius) dx = -dx;
        if(y + dy < ballRadius) dy = -dy;
        else if(y + dy > canvas.height-ballRadius) {
            if(x > paddleX && x < paddleX + paddleWidth) dy = -dy;
            else { gameOver(); return; }
        }

        x += dx; y += dy;
        requestAnimationFrame(draw);
    }

    showMenu(); // Start od menu
</script>

</body>
</html>
